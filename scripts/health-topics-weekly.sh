#!/bin/bash

# å¥åº·å…¬ä¼—å·é€‰é¢˜ç”Ÿæˆå™¨
# åŸºäºŽç›‘æŽ§çš„ 10 ä¸ªå…¬ä¼—å·ï¼Œæ¯å‘¨ç”Ÿæˆé€‰é¢˜å»ºè®®

WORKSPACE="$HOME/.openclaw/workspace"
OBSIDIAN="$WORKSPACE/obsidian-vault"
DATE=$(date +%Y-%m-%d)
WEEK=$(date +%Y-W%V)

echo "ðŸ“ å¥åº·å…¬ä¼—å·é€‰é¢˜ç”Ÿæˆ - $WEEK"
echo "========================================"

# åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p "$OBSIDIAN/å…¬ä¼—å·ç›‘æŽ§/æ¯å‘¨é€‰é¢˜"

REPORT_FILE="$OBSIDIAN/å…¬ä¼—å·ç›‘æŽ§/æ¯å‘¨é€‰é¢˜/$WEEK.md"

# èŽ·å–æœ¬å‘¨çƒ­é—¨å¥åº·è¯é¢˜ï¼ˆé€šè¿‡æœç´¢ï¼‰
echo "ðŸ” æœç´¢æœ¬å‘¨å¥åº·çƒ­ç‚¹..."

export TAVILY_API_KEY="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"

# 1. æœç´¢å¥åº·çƒ­ç‚¹
HEALTH_TRENDS=$(node ~/.openclaw/workspace/skills/tavily-search/scripts/search.mjs \
  "å¥åº· åŒ»ç–— ç§‘æ™® 2026 æœ€æ–° ç ”ç©¶ å‘çŽ°" \
  -n 10 \
  --topic news \
  --days 7 2>&1)

# 2. æœç´¢ä¸­åŒ»å…»ç”Ÿçƒ­ç‚¹
TCM_TRENDS=$(node ~/.openclaw/workspace/skills/tavily-search/scripts/search.mjs \
  "ä¸­åŒ» å…»ç”Ÿ å¥åº· 2026 èŠ‚æ°” å…»ç”Ÿ" \
  -n 8 \
  --topic news \
  --days 7 2>&1)

# 3. æœç´¢æ¯å©´å¥åº·çƒ­ç‚¹
MOM_BABY_TRENDS=$(node ~/.openclaw/workspace/skills/tavily-search/scripts/search.mjs \
  "æ¯å©´ è‚²å„¿ ç–«è‹— å„¿ç«¥ å¥åº· 2026" \
  -n 8 \
  --topic news \
  --days 7 2>&1)

# ç”Ÿæˆé€‰é¢˜æŠ¥å‘Š
cat > "$REPORT_FILE" <<EOF
# ðŸ“ å¥åº·å…¬ä¼—å·æ¯å‘¨é€‰é¢˜ - $WEEK

**ç”Ÿæˆæ—¶é—´**ï¼š$(date '+%Y-%m-%d %H:%M:%S')
**ç›®æ ‡å…¬ä¼—å·**ï¼š10 ä¸ª

---

## ðŸ¥ ä¸é¦™ç³»åˆ—é€‰é¢˜ï¼ˆ4 ä¸ªå…¬ä¼—å·ï¼‰

### ä¸é¦™åŒ»ç”Ÿ
**ç›®æ ‡å—ä¼—**ï¼šå¤§ä¼—å¥åº·ç§‘æ™®

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€å­£èŠ‚å¥åº·ã€‘$(date +%m)æœˆæ¢å­£å¥åº·æŒ‡å—ï¼š5ä¸ªå¸¸è§è¯¯åŒº
2. ã€è¾Ÿè°£ã€‘æœ¬å‘¨çƒ­ä¼ å¥åº·è°£è¨€ Top 3
3. ã€æ–°ç ”ç©¶ã€‘æœ€æ–°åŒ»å­¦å‘çŽ°ï¼šX å¯¹å¥åº·çš„å½±å“
4. ã€å®žç”¨æŠ€å·§ã€‘å®¶åº­å¸¸å¤‡è¯ç®±æ›´æ–°æŒ‡å—

### ä¸é¦™å›­
**ç›®æ ‡å—ä¼—**ï¼šåŒ»ç–—ä¸“ä¸šäººå£«

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€è¡Œä¸šåŠ¨æ€ã€‘åŒ»ç–—æ”¿ç­–æœ€æ–°è§£è¯»
2. ã€ä¸´åºŠç ”ç©¶ã€‘æœ€æ–°ä¸´åºŠæŒ‡å—æ›´æ–°
3. ã€èŒåœºå‘å±•ã€‘åŒ»ç”ŸèŒä¸šè§„åˆ’å»ºè®®
4. ã€æŠ€æœ¯å‰æ²¿ã€‘AI åœ¨åŒ»ç–—é¢†åŸŸçš„åº”ç”¨

### ä¸é¦™å¦ˆå¦ˆ
**ç›®æ ‡å—ä¼—**ï¼šå®å¦ˆç¾¤ä½“

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€è‚²å„¿å¹²è´§ã€‘$(date +%m)æœˆå®å®æŠ¤ç†è¦ç‚¹
2. ã€ç–«è‹—ç§‘æ™®ã€‘æœ€æ–°ç–«è‹—æŽ¥ç§æŒ‡å—
3. ã€è¥å…»æ­é…ã€‘å®å®è¾…é£Ÿæ·»åŠ æŒ‡å—
4. ã€å®‰å…¨æé†’ã€‘å„¿ç«¥å¸¸è§æ„å¤–é¢„é˜²

### ä¸é¦™ç”Ÿæ´»ç ”ç©¶
**ç›®æ ‡å—ä¼—**ï¼šå…³æ³¨ç”Ÿæ´»å“è´¨çš„äººç¾¤

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€ç”Ÿæ´»æŠ€å·§ã€‘æå‡ç”Ÿæ´»è´¨é‡çš„å°ä¹ æƒ¯
2. ã€äº§å“æµ‹è¯„ã€‘å¥åº·ç”Ÿæ´»å¥½ç‰©æŽ¨è
3. ã€å¿ƒç†å¥åº·ã€‘åŽ‹åŠ›ç®¡ç†å®žç”¨æ–¹æ³•
4. ã€ç¡çœ æ”¹å–„ã€‘ç§‘å­¦ç¡çœ æŒ‡å—

---

## ðŸŒ¿ ä¸­åŒ»ç³»åˆ—é€‰é¢˜ï¼ˆ3 ä¸ªå…¬ä¼—å·ï¼‰

### é¹¤ç«‹çƒŸé›¨
**ç›®æ ‡å—ä¼—**ï¼šä¸­åŒ»çˆ±å¥½è€…

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€èŠ‚æ°”å…»ç”Ÿã€‘$(date +%m)æœˆèŠ‚æ°”å…»ç”Ÿè¦ç‚¹
2. ã€ä½“è´¨è°ƒç†ã€‘ä¸åŒä½“è´¨çš„é¥®é£Ÿå»ºè®®
3. ã€ç»å…¸æ–¹å‰‚ã€‘å¸¸ç”¨ä¸­è¯æ–¹è§£è¯»
4. ã€ä¸­åŒ»æ™ºæ…§ã€‘ä¼ ç»Ÿå…»ç”Ÿç†å¿µçŽ°ä»£åº”ç”¨

### æ–‡å°å”è¯´
**ç›®æ ‡å—ä¼—**ï¼šä¸­åŒ»å…¥é—¨è€…

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€åŸºç¡€ç§‘æ™®ã€‘ä¸­åŒ»åŸºç¡€æ¦‚å¿µè§£è¯»
2. ã€ç©´ä½å…»ç”Ÿã€‘æ—¥å¸¸ä¿å¥ç©´ä½æŽ¨è
3. ã€é£Ÿç–—æ–¹ã€‘å½“å­£å…»ç”Ÿé£Ÿè°±
4. ã€å…»ç”Ÿè¯¯åŒºã€‘å¸¸è§å…»ç”Ÿè¯¯åŒºçº æ­£

### æ¸©æš–ä¸­åŒ»
**ç›®æ ‡å—ä¼—**ï¼šè¿½æ±‚è‡ªç„¶ç–—æ³•çš„äººç¾¤

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€è‡ªç„¶ç–—æ³•ã€‘æ¸©å’Œè°ƒç†æ–¹æ³•æŽ¨è
2. ã€æƒ…å¿—å…»ç”Ÿã€‘æƒ…ç»ªä¸Žèº«ä½“å¥åº·
3. ã€å››å­£è°ƒå…»ã€‘å­£èŠ‚æ€§å…»ç”Ÿé‡ç‚¹
4. ã€è¯è†³æŽ¨èã€‘å®¶åº­è¯è†³åˆ¶ä½œ

---

## ðŸ“Š åŒ»ç–—èµ„è®¯é€‰é¢˜ï¼ˆ3 ä¸ªå…¬ä¼—å·ï¼‰

### ç²¤å«å¹³å°
**ç›®æ ‡å—ä¼—**ï¼šå¹¿ä¸œåœ°åŒºåŒ»ç–—ä»Žä¸šè€…

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€æœ¬åœ°åŠ¨æ€ã€‘å¹¿ä¸œåŒ»ç–—æ”¿ç­–æ›´æ–°
2. ã€åŒ»é™¢èµ„è®¯ã€‘æœ¬åœ°åŒ»é™¢æ–°é—»
3. ã€å¥åº·æ´»åŠ¨ã€‘ä¹‰è¯Šã€å¥åº·è®²åº§é¢„å‘Š
4. ã€åŒ»ä¿æ”¿ç­–ã€‘åŒ»ä¿æŠ¥é”€æŒ‡å—

### drpei
**ç›®æ ‡å—ä¼—**ï¼šå…³æ³¨åŒ»å­¦ç§‘æ™®çš„äººç¾¤

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€ç–¾ç—…ç§‘æ™®ã€‘å¸¸è§ç–¾ç—…é¢„é˜²æŒ‡å—
2. ã€ç”¨è¯å®‰å…¨ã€‘æ­£ç¡®ç”¨è¯çŸ¥è¯†
3. ã€æ£€æŸ¥è§£è¯»ã€‘ä½“æ£€æŠ¥å‘Šæ€Žä¹ˆçœ‹
4. ã€å°±åŒ»æŒ‡å—ã€‘å¦‚ä½•é«˜æ•ˆå°±åŒ»

### çº¦è‹—
**ç›®æ ‡å—ä¼—**ï¼šéœ€è¦æŽ¥ç§ç–«è‹—çš„äººç¾¤

**é€‰é¢˜å»ºè®®**ï¼š
1. ã€ç–«è‹—ç§‘æ™®ã€‘å„ç±»ç–«è‹—è¯¦è§£
2. ã€æŽ¥ç§æŒ‡å—ã€‘ç–«è‹—æŽ¥ç§æ—¶é—´è¡¨
3. ã€é¢„çº¦æ•™ç¨‹ã€‘å¦‚ä½•å¿«é€Ÿé¢„çº¦ç–«è‹—
4. ã€ä¸è‰¯ååº”ã€‘ç–«è‹—æŽ¥ç§æ³¨æ„äº‹é¡¹

---

## ðŸ”¥ æœ¬å‘¨çƒ­ç‚¹è¯é¢˜ï¼ˆå¯è·¨å·ä½¿ç”¨ï¼‰

$HEALTH_TRENDS

---

## ðŸ“ˆ é€‰é¢˜ä¼˜å…ˆçº§å»ºè®®

| ä¼˜å…ˆçº§ | ç±»åž‹ | åŽŸå›  |
|--------|------|------|
| â­â­â­â­â­ | å­£èŠ‚å¥åº· | ç´§è·Ÿæ—¶ä»¤ï¼Œç”¨æˆ·å…³æ³¨åº¦é«˜ |
| â­â­â­â­â­ | çƒ­ç‚¹è¾Ÿè°£ | ä¼ æ’­æ€§å¼ºï¼Œæ˜“å¼•å‘è½¬å‘ |
| â­â­â­â­ | å®žç”¨å¹²è´§ | æ”¶è—ä»·å€¼é«˜ |
| â­â­â­â­ | æ–°ç ”ç©¶è§£è¯» | æƒå¨æ€§å¼ºï¼Œå»ºç«‹ä¸“ä¸šå½¢è±¡ |
| â­â­â­ | æƒ…æ„Ÿå…±é¸£ | æ˜“å¼•å‘äº’åŠ¨è®¨è®º |

---

## ðŸ’¡ åˆ›ä½œå»ºè®®

### æ ‡é¢˜æŠ€å·§
- æ•°å­—åŒ–ï¼šX ä¸ªæ–¹æ³•ã€Top X
- ç–‘é—®å¼ï¼šä¸ºä»€ä¹ˆ...ï¼Ÿå¦‚ä½•...ï¼Ÿ
- å¯¹æ¯”å¼ï¼šA vs Bï¼Œå“ªä¸ªæ›´å¥½ï¼Ÿ
- è­¦ç¤ºå¼ï¼šåˆ«å†...äº†ï¼ŒåŽæžœå¾ˆä¸¥é‡

### å†…å®¹ç»“æž„
1. **å¼€å¤´**ï¼šç—›ç‚¹å…±é¸£ + æ‰¿è¯ºä»·å€¼
2. **æ­£æ–‡**ï¼šåˆ†ç‚¹é˜è¿° + å›¾æ–‡å¹¶èŒ‚
3. **ç»“å°¾**ï¼šæ€»ç»“ + äº’åŠ¨å¼•å¯¼

### å‘å¸ƒæ—¶é—´
- æ—©é«˜å³°ï¼š7:00-8:00
- åˆä¼‘ï¼š12:00-13:00
- æ™šé«˜å³°ï¼š18:00-20:00
- å‘¨æœ«ï¼š10:00-11:00

---

## ðŸ“Š æ•°æ®è¿½è¸ª

å»ºè®®è¿½è¸ªä»¥ä¸‹æŒ‡æ ‡ï¼š
- é˜…è¯»é‡
- åˆ†äº«é‡
- æ”¶è—é‡
- åœ¨çœ‹é‡
- è¯„è®ºåŒºäº’åŠ¨

---

**è‡ªåŠ¨ç”Ÿæˆ**ï¼šOpenClaw å¥åº·å…¬ä¼—å·é€‰é¢˜ç³»ç»Ÿ
**ä¸‹æ¬¡æ›´æ–°**ï¼šä¸‹å‘¨ä¸€
EOF

echo "âœ… é€‰é¢˜æŠ¥å‘Šå·²ç”Ÿæˆï¼š$REPORT_FILE"

# åŒæ­¥åˆ° Git
cd "$OBSIDIAN"
git add "å…¬ä¼—å·ç›‘æŽ§/æ¯å‘¨é€‰é¢˜/$WEEK.md"
git commit -m "ðŸ“ å¥åº·å…¬ä¼—å·æ¯å‘¨é€‰é¢˜ - $WEEK" 2>/dev/null
git push

echo "âœ… å·²åŒæ­¥åˆ° GitHub"

# ç”Ÿæˆé€šçŸ¥
mkdir -p /tmp/notify
cat > /tmp/notify/health-topics-weekly.txt <<EOF
ðŸ“ å¥åº·å…¬ä¼—å·æ¯å‘¨é€‰é¢˜å·²ç”Ÿæˆ

ðŸ“Š æœ¬å‘¨é€‰é¢˜ï¼š
- ä¸é¦™ç³»åˆ—ï¼š16 ä¸ªé€‰é¢˜å»ºè®®
- ä¸­åŒ»ç³»åˆ—ï¼š12 ä¸ªé€‰é¢˜å»ºè®®
- åŒ»ç–—èµ„è®¯ï¼š12 ä¸ªé€‰é¢˜å»ºè®®
- çƒ­ç‚¹è¯é¢˜ï¼š+ æœ¬å‘¨å¥åº·çƒ­ç‚¹

ðŸ“‹ æŠ¥å‘Šä½ç½®ï¼šobsidian-vault/å…¬ä¼—å·ç›‘æŽ§/æ¯å‘¨é€‰é¢˜/$WEEK.md

ðŸ’¡ å»ºè®®ï¼šç»“åˆçƒ­ç‚¹æ•°æ®è°ƒæ•´é€‰é¢˜ä¼˜å…ˆçº§
EOF

echo ""
echo "========================================"
echo "âœ… å¥åº·å…¬ä¼—å·é€‰é¢˜ç”Ÿæˆå®Œæˆï¼"
echo ""
echo "ðŸ“‹ æŸ¥çœ‹é€‰é¢˜ï¼š"
echo "  cat $REPORT_FILE"
